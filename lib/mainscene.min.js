var scene,camera,controls,renderer,SCREEN_WIDTH,SCREEN_HEIGHT,loader,sound,mscale=.5;function deg(a){return a*Math.PI/180}var rr=deg(90),lcg=new THREE.PlaneGeometry(20,20,1),lgm=new THREE.MeshPhongMaterial({color:15788328}),loadCube=new THREE.Mesh(lcg,lgm);loadCube.scale.set(.001,.001,.001);loadCube.position.y=-6;loadCube.rotation.x=-rr;function startLoad(){scene.add(loadCube)}
function endLoad(){(new TWEEN.Tween(loadCube.scale)).to({x:.001,y:.001,z:.001},2E3).easing(TWEEN.Easing.Exponential.Out).start();scene.remove(loadCube)}var manager=new THREE.LoadingManager;manager.onStart=function(){startLoad()};manager.onProgress=function(a,b,c){a=b/c*100/100;(new TWEEN.Tween(loadCube.scale)).to({x:a,y:a,z:a},500).easing(TWEEN.Easing.Exponential.Out).start()};manager.onLoad=function(){endLoad()};loader=new THREE.JSONLoader(manager);
var tx_loader=new THREE.TextureLoader(manager),group=new THREE.Group;group.name="Model Lampy";
function init(){scene=new THREE.Scene;scene.name="SCENE SPOT LIGHT";camera=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,500);renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0});renderer.shadowMap.enabled=!0;renderer.shadowMap.type=THREE.PCFSoftShadowMap;renderer.setClearColor(0,0);renderer.setPixelRatio(window.devicePixelRatio);renderer.setSize(window.innerWidth,window.innerHeight);controls=new THREE.OrbitControls(camera,renderer.domElement);controls.dampingFactor=.15;
controls.enableDamping=!0;controls.enablePan=!1;var a=new THREE.AudioListener;camera.add(a);sound=new THREE.Audio(a);var b=new THREE.AudioLoader;b.load("lib/music/lopo.wav",function(a){sound.setBuffer(a);sound.setLoop(!0);sound.setVolume(.05);sound.play()});click=new THREE.Audio(a);b.load("lib/music/click.wav",function(a){click.setBuffer(a);click.setVolume(.05)});controls.minPolarAngle=-Math.PI/2;controls.maxPolarAngle=Math.PI/2;controls.minDistance=30;controls.maxDistance=40;controls.addEventListener("change",
render);camera.position.x=25;camera.position.y=15;camera.position.z=25;camera.lookAt(scene.position);a=new THREE.HemisphereLight(16576717,526368,.58);a.name="hemisphere";scene.add(a);a=new THREE.DirectionalLight(16777215,.26);a.position.set(-10,10,5);a.castShadow=!0;a.name="Directional Light";scene.add(a);a=new THREE.SpotLight(16777215,.8);a.position.set(-30,10,30);a.castShadow=!0;a.shadow.bias=-.001;a.shadow.camera.near=.1;a.shadow.camera.far=100;a.shadow.camera.fov=45;a.shadow.angle=1.05;a.shadow.mapSize.width=
2048;a.shadow.mapSize.height=2048;a.name="spotlight 1";scene.add(a);a=new THREE.SpotLight(16777215,.46);a.position.set(30,10,-80);a.name="spotlight 2";scene.add(a);a=new THREE.GridHelper(10,5);a.name="Grid Helper";a.position.y=-6;scene.add(a);var a=(new THREE.TextureLoader).load("lib/models/TEXTURES/topjpg.jpg"),b=(new THREE.TextureLoader).load("lib/models/TEXTURES/pobrane.png"),c=new THREE.MeshPhongMaterial({map:a,bumpMap:b,shininess:5,reflectivity:5,bumpScale:.01,combine:THREE.MultiplyOperation});
loader.load("lib/models/2238174/top.json",function(a){a=new THREE.Mesh(a,c);a.material.needsUpdate=!0;a.position.set(0,0,0);a.scale.set(mscale,mscale,mscale);a.castShadow=!0;a.receiveShadow=!0;a.name="top";group.add(a)});loader.load("lib/models/2238174/baza.json",function(a){a=new THREE.Mesh(a,c);a.material.needsUpdate=!0;a.position.set(0,0,0);a.scale.set(mscale,mscale,mscale);a.castShadow=!0;a.receiveShadow=!0;a.name="bottom";group.add(a)});var d=new THREE.MeshPhongMaterial({color:10724259,emissive:0});
loader.load("lib/models/2238174/light_source.json",function(a){a=new THREE.Mesh(a,d);a.material.needsUpdate=!0;a.position.set(0,0,0);a.scale.set(mscale,mscale,mscale);a.name="light";group.add(a)});group.position.y=-6;group.rotation.y=-Math.PI/2;group.scale.set(.01,.01,.01);scene.add(group);$("#container").append(renderer.domElement)}function render(){}function animate(){requestAnimationFrame(animate);controls.update();TWEEN.update();render();renderer.render(scene,camera)}
function initAnimate(a){(new TWEEN.Tween(group.scale)).to({x:a,y:a,z:a},2E3).easing(TWEEN.Easing.Exponential.Out).delay(500).start();(new TWEEN.Tween(group.rotation)).to({y:Math.PI},2E3).easing(TWEEN.Easing.Exponential.Out).delay(500).start()}init();animate();var currentIndex=0,modelsCount=models.length-1,currentModel=0;$(".prev_model").on("click",function(){click.play();currentModel=0==currentModel?modelsCount:currentModel-1;loadNew()});
$(".next_model").on("click",function(){click.play();currentModel=currentModel==modelsCount?0:currentModel+1;loadNew()});function animIn(){var a=scene.getObjectByName("top"),b=scene.getObjectByName("bottom"),c=scene.getObjectByName("light");group.remove(a,b,c);models[currentModel][0].loadmodel();(new TWEEN.Tween(group.scale)).to({x:1,y:1,z:1},500).easing(TWEEN.Easing.Exponential.Out).start();(new TWEEN.Tween(group.rotation)).to({y:Math.PI},500).easing(TWEEN.Easing.Exponential.Out).start()}
function loadNew(a){(new TWEEN.Tween(group.scale)).to({x:.1,y:.1,z:.1},500).easing(TWEEN.Easing.Exponential.Out).start();(new TWEEN.Tween(group.rotation)).to({y:-Math.PI},500).easing(TWEEN.Easing.Exponential.Out).onComplete(animIn).start()}$("#light-switch").on("click",function(){var a=scene.getObjectByName("light");"off"==$(this).attr("state")?(a.material.emissive.setHex(16777215),$(this).attr("state","on")):(a.material.emissive.setHex(0),$(this).attr("state","off"))});
$(".fullscreen_container").on("click",function(){"on"==$(this).attr("state")?(THREEx.FullScreen.cancel(),$(this).attr("state","off")):(THREEx.FullScreen.request(),$(this).attr("state","on"))});$(".volume_container").on("click",function(){"on"==$(this).attr("state")?(sound.pause(),$(this).children("img").attr("src","lib/music/off.svg"),$(this).attr("state","off")):(sound.play(),$(this).children("img").attr("src","lib/music/on.svg"),$(this).attr("state","on"))});
function onWindowResize(){camera.aspect=window.innerWidth/window.innerHeight;camera.updateProjectionMatrix();renderer.setSize(window.innerWidth,window.innerHeight)}window.addEventListener("resize",onWindowResize,!1);
